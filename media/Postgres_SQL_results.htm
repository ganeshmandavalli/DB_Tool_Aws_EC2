<html lang="en">
                                                                                    <head>
                                                                                       <meta charset="UTF-8">
                                                                                       <meta name="viewport" content="width=device-width, initial-scale=1.0">
                                                                                       <title>Audit Report</title>
                                                                                       <style>
                                                                                          body { font-family: Arial, sans-serif; margin: 20px; }
                                                                                          .header { text-align: right; font-size: 14px; margin-bottom: 10px; }
                                                                                          .info-box { background-color: #f2f2f2; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-size: 14px; line-height: 1.5; }
                                                                                          h2 { color: #00008B; text-align: center; margin-top: 20px; }
                                                                                          h3 { color: #00008B; text-align: left; margin-top: 20px; }
                                                                                          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                                                                                          table, th, td { border: 1px solid #ddd; }
                                                                                          th, td { padding: 12px; text-align: left; }
                                                                                          th { background-color: #00008B; color: white; }
                                                                                          tr:nth-child(even) { background-color: #f2f2f2; }
                                                                                          .status-passed { color: green; }
                                                                                          .status-failed { color: red; }
                                                                                          .status-manual { color: black; }
                                                                                          .status-nopermission { color: yellow; }
                                                                                          .footer { text-align: center; font-size: 14px; margin-top: 30px; padding: 10px 0; }
                                                                                       </style>
                                                                                  </head>
                                                                                  <body>
                                                                                      <div class="header"><strong>Audit Date: </strong>2025-02-19 13:54:38</div>
                                                                                  <div class="info-box">
                                                                                  <p><strong>PostgreSQL 16.4, compiled by Visual C++ build 1941, 64-bit</strong><br> </p> 
                                                                                 </div><h2>Database Audit Report - CIS PostgreSQL Benchmark</h2><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                                         <strong>1. PostgreSQL Database Installation and Patching </strong>  
                                                                                     </p><table>
                                                                          <tr>
                                                                              <th>Check</th>
                                                                              <th>Status</th>
                                                                          </tr><tr>
                                                                       <td>1.1 Ensure packages are obtained from authorized repositories (Manual)</td>
                                                                       <td class="status-manual">Manual</td>
                                                                </tr><tr>
                                                                                  <td>1.2 Ensure systemd Service Files Are Enabled (Automated)</td>
                                                                                  <td class="status-passed">Passed</td>
                                                                              </tr><tr>
                                                                            <td>1.3 Ensure Data Cluster Initialized Successfully (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr>
                                                                        <tr>
                                                                             <td colspan="2"><strong>NOTE:</strong> 1.3 It will work for the Admin, but the current user might not have the required permission.</td>
                                                                        </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                  <strong>2. Directory and File Permissions</strong>  
                                                                </p><table>
                                                                          <tr>
                                                                              <th>Check</th>
                                                                              <th>Status</th>
                                                                          </tr><tr>
                                                                      <td>2.1 Ensure the file permissions mask is correct (Manual for Linux)</td>
                                                                      <td class="status-manual">No Need</td>
                                                                  </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                                            <strong>3. Logging And Auditing</strong>  
                                                                                        </p><p style="color: #00008B; font-size: 19px; text-align: left; margin-top: 19px;">
                                                                                              <strong>3.1 PostgreSQL Logging</strong>  
                                                                                        </p><p style="color: #00008B; font-size: 19px; text-align: left; margin-top: 19px;">
                                                                                  <strong>3.1.1 Logging Rationale</strong>  
                                                                 </p><table>
                                                                        <tr>
                                                                            <th>Check</th>
                                                                            <th>Status</th>
                                                                        </tr><tr>
                                                                              <td>3.1.2 Ensure the log destinations are set correctly (Automated)</td>
                                                                              <td class="status-passed">Passed</td>
                                                                              </tr><tr>
                                                                              <td> 3.1.3 Ensure the logging collector is enabled (Automated)</td>
                                                                              <td class="status-passed">Passed</td>
                                                                          </tr><tr>
                                                                            <td>3.1.4 Ensure the log file destination directory is set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.5 Ensure the filename pattern for log files is set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.6 Ensure the log file permissions are set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.7 Ensure 'log_truncate_on_rotation' is enabled (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.8 Ensure the maximum log file lifetime is set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.9 Ensure the maximum log file size is set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.10 Ensure the correct syslog facility is selected (Manual)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.11 Ensure syslog messages are not suppressed (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.12 Ensure syslog messages are not lost due to size (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.13 Ensure the program name for PostgreSQL syslog messages is correct (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                              <td>3.1.14 Ensure the correct messages are written to the server log (Automated)</td>
                                                                              <td class="status-passed">Passed</td>
                                                                          </tr><tr>
                                                                              <td>3.1.15 Ensure the correct SQL statements generating errors are recorded (Automated)</td>
                                                                              <td class="status-passed">Passed</td>
                                                                      </tr><tr>
                                                                            <td>3.1.16 Ensure 'debug_print_parse' is disabled (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.17 Ensure 'debug_print_rewritten' is disabled (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.18 Ensure 'debug_print_plan' is disabled (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.19 Ensure 'debug_pretty_print' is enabled (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.20 Ensure 'log_connections' is enabled (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.21 Ensure 'log_disconnections' is enabled (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.22 Ensure 'log_error_verbosity' is set to 'verbose' (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.23 Ensure 'log_hostname' is set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.24 Ensure 'log_line_prefix' is set correctly (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.25 Ensure 'log_statement' is set correctly (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                            <td>3.1.26 Ensure 'log_timezone' is set correctly (Automated)</td>
                                                                            <td class="status-passed">Passed</td>
                                                                        </tr><td><b>Note:</b> Returning the <b> <i>Asia/Calcutta.</b> </i> Check with your organization as defined by the logging policy.</td><tr>
                                                                            <td>3.2 Ensure the PostgreSQL Audit Extension (pgAudit) is enabled (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                        </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                                                                         <strong> 4. User Access and Authorization </strong>  
                                                                 </p><table>
                                                                        <tr>
                                                                             <th>Check</th>
                                                                             <th>Status</th>
                                                                        </tr><tr>
                                                                      <td> 4.1 Ensure sudo is configured correctly (Manual)</td>
                                                                     <td class="status-nopermission">No Permission</td>
                                                                 </tr><td><b>Note:</b> Need an administration priviliges </td><tr>
                                                                      <td>4.2 Ensure excessive administrative privileges are revoked (Manual)</td>
                                                                      <td class="status-nopermission">No Permission</td>
                                                                  </tr><td><b>Note:</b> Need an administration priviliges </td><tr>
                                                                      <td>4.3 Ensure excessive function privileges are revoked (Automated)</td>
                                                                      <td class="status-nopermission">No Permission</td>
                                                                  </tr><td><b>Note:</b> Need an POSTGRES user (Super user) priviliges </td><tr>
                                                                     <td>4.4 Ensure excessive DML privileges are revoked (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                                  </tr><tr>
                                                                              <td>4.5 Ensure Row Level Security (RLS) is configured correctly (Manual)</td>
                                                                              <td class="status-failed">Failed</td>
                                                                         </tr><td><b>Note:</b> The decision to implement Row Level Security (RLS) depends on an 
                                                                              organization's specific business processes and security needs.</td><tr>
                                                                              <td>4.6 Ensure the set_user extension is installed (Automated)</td>
                                                                              <td class="status-failed">Failed</td>
                                                                        </tr><td><b>Note:</b> Check the admin users in our organization to ensure accurate identification of superuser roles.</td><tr>
                                                                      <td>4.7 Make use of predefined roles (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                                  </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                                  <strong>5. Connection and Login</strong>  
                                                                 </p><table>
                                                                      <tr>
                                                                          <th>Check</th>
                                                                          <th>Status</th>
                                                                      </tr><tr>
                                                                      <td>5.1 Ensure login via "local" UNIX Domain Socket is configured correctly (Manual)</td>
                                                                      <td class="status-manual">No Need</td>
                                                               </tr><tr>
                                                                      <td>5.2 Ensure login via "host" TCP/IP Socket is configured correctly (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                                  </tr><tr>
                                                                              <td>5.3 Ensure Password Complexity is configured (Manual)</td>
                                                                              <td class="status-failed">Failed</td>
                                                                        </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                                                                  <strong>6. PostgreSQL Settings</strong>  
                                                                                                 </p><table>
                                                                        <tr>
                                                                            <th>Check</th>
                                                                            <th>Status</th>
                                                                        </tr><tr>
                                                                      <td>6.1 Understanding attack vectors and runtime parameters (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                                  </tr><tr>
                                                                              <td>6.2 Ensure 'backend' runtime parameters are configured correctly (Automated)</td>
                                                                              <td class="status-failed">Failed</td>
                                                                        </tr><tr>
                                                                      <td>6.3 Ensure 'Postmaster' runtime parameters are configured correctly (Manual)</td>
                                                                       <td class="status-manual">Manual</td>
                                                                  </tr><tr>
                                                                      <td>6.4 Ensure 'SIGHUP' Runtime Parameters are Configured (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                               </tr><tr>
                                                                     <td>6.5 Ensure 'Superuser' Runtime Parameters are Configured (Manual)</td>
                                                                     <td class="status-manual">Manual</td>
                                                                  </tr><tr>
                                                                      <td>6.6 Ensure 'User' Runtime Parameters are Configured (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                               </tr><tr>
                                                                      <td>6.7 Ensure FIPS 140-2 OpenSSL Cryptography Is Used (Automated)</td>
                                                                      <td class="status-nopermission">No Permission</td>
                                                                  </tr><td><b>Note:</b> Only system administrator has the permission</td><tr>
                                                                            <td>6.8 Ensure TLS is enabled and configured correctly (Automated)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                          </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                  <strong> 7. Replication</strong>  
                                                                 </p><table>
                                                                        <tr>
                                                                            <th>Check</th>
                                                                            <th>Status</th>
                                                                        </tr><tr>
                                                                            <td>7.1 Ensure a replication-only user is created and used for streaming replication (Manual)</td>
                                                                            <td class="status-failed">Failed</td>
                                                                          </tr><tr>
                                                                          <td>7.2 Ensure logging of replication commands is configured (Manual)</td>
                                                                          <td class="status-failed">Failed</td>
                                                                      </tr><tr>
                                                                     <td>7.3 Ensure base backups are configured and functional (Manual)</td>
                                                                     <td class="status-manual">Manual</td>
                                                                </tr><tr>
                                                                          <td>7.4 Ensure WAL archiving is configured and functional (Automated)</td>
                                                                          <td class="status-failed">Failed</td>
                                                                      </tr><tr>
                                                                      <td>7.5 Ensure streaming replication parameters are configured correctly (Manual)</td>
                                                                      <td class="status-manual">Manual</td>
                                                                  </tr></table><p style="color: #00008B; font-size: 20px; text-align: left; margin-top: 20px;">
                                                                          <strong>8. Special Configuration Considerations</strong>  
                                                              </p><table>
                                                                        <tr>
                                                                            <th>Check</th>
                                                                            <th>Status</th>
                                                                        </tr><tr>
                                                                          <td>8.1 Ensure PostgreSQL subdirectory locations are outside the data cluster (Manual)</td>
                                                                          <td class="status-passed">Passed</td>
                                                                        </tr><tr>
                                                                      <td>8.2 Ensure the backup and restore tool, 'pgBackRest', is installed and configured (Automated)</td>
                                                                      <<td class="status-nopermission">NoPermission</td>
                                                                    </tr><td><b>Note:</b> To ensure that your organization implements an effective backup solution for PostgreSQL databases, 
                                                      similar to pgBackRest's features</table><table class="summary-table" style="width: 100%; margin-top: 20px; border-collapse: collapse;">
                                                                                              <tr>
                                                                                                  <th>Total Passed</th>
                                                                                                  <th>Total Failed</th>
                                                                                                  <th>Total Manual</th>
                                                                                                  <th>No Permission</th>
                                                                                              </tr>
                                                                                              <tr>
                                                                                                  <td class="status-passed" style="text-align: center;">20</td>
                                                                                                  <td class="status-failed" style="text-align: center;">16</td>
                                                                                                  <td class="status-manual" style="text-align: center;">11</td>
                                                                                                  <td class="status-nopermission" style="text-align: center;">5</td>
                                                                                              </tr>
                                                                                            </table>
                                                                                                <footer style="text-align: center; font-size: 14px; margin-top: 30px; padding: 10px 0;">
                                                                                                    <p>2024 All Rights Reserved to Secure Auditix tool</p>
                                                                                                    <p>Coded and UI Designed by <strong>Mandavalli Ganesh<strong></p>
                                                                                                </footer>
                                                                                         </body>
                                                                                     </html>